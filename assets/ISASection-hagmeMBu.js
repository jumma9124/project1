import{r as p,j as t}from"./index-DwQk8TQ8.js";const v="06b3477db7333064915456425b02c1111869ed411d0c1b277de5d212ea7464be",y="https://apis.data.go.kr/1160100/GetISAInfoService_V2",k={card:"bg-white rounded-[2.5rem] p-6 shadow-sm border border-[#FFEDD5]/30"};function J({showIndustryTip:u,setShowIndustryTip:f,showTaxTip:g,setShowTaxTip:m,onTipOpen:N}){const[l,A]=p.useState([]),[F,w]=p.useState([]),[R,D]=p.useState(!0);p.useEffect(()=>{(async()=>{try{const s=`${y}/getMPBenefitRateInfo_V2?serviceKey=${v}&pageNo=1&numOfRows=1000&resultType=json`,n=await fetch(s);if(!n.ok)throw new Error(`HTTP 에러! 상태: ${n.status}`);const o=(await n.json()).response?.body?.items?.item||[],i=Array.isArray(o)?o:[o],c={};i.forEach(e=>{e.trm==="1년"&&e.cmpyNm&&(!c[e.cmpyNm]||parseFloat(e.bnfRt||0)>parseFloat(c[e.cmpyNm].bnfRt||0))&&(c[e.cmpyNm]=e)});const S=Object.values(c).sort((e,r)=>parseFloat(r.bnfRt||0)-parseFloat(e.bnfRt||0)).slice(0,5);A(S);const C=`${y}/getJoinStatus_V2?serviceKey=${v}&pageNo=1&numOfRows=1000&resultType=json`,b=await fetch(C);if(!b.ok)throw new Error(`HTTP 에러! 상태: ${b.status}`);const h=(await b.json()).response?.body?.items?.item||[],j=Array.isArray(h)?h:[h],I=j.length>0?j[0].basDt:null,P=j.filter(e=>e.basDt===I),x={};P.forEach(e=>{const r=e.ctg||"기타";x[r]||(x[r]={ctg:r,jnpnCnt:0,invAmt:0,basDt:e.basDt}),x[r].jnpnCnt+=parseInt(e.jnpnCnt||0),x[r].invAmt+=parseInt(e.invAmt||0)});const $=Object.values(x).sort((e,r)=>r.jnpnCnt-e.jnpnCnt);w($)}catch(s){console.error("ISA API 연동 실패:",s)}finally{D(!1)}})()},[]);const E=()=>{m(!1),f(!1)};return t.jsxs("div",{onClick:E,children:[t.jsx("div",{className:"px-6 mt-8",children:t.jsxs("div",{className:k.card,children:[t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsxs("div",{className:"flex items-center gap-1.5 mb-4",children:[t.jsx("h3",{className:"text-sm font-bold text-[#4A3F35] flex items-center",children:"1년 수익률 높은 금융사 TOP5"}),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:a=>{a.stopPropagation(),f(!u),m(!1),N()},className:"text-red-500 text-sm font-bold",children:"!"}),u&&(()=>{const a=F.filter(s=>s.ctg==="증권"||s.ctg==="은행");return t.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 bg-[#4A3F35] rounded-lg px-3 py-2 whitespace-nowrap z-10",children:[t.jsx("div",{className:"text-[11px] text-white tracking-tighter",children:a.map((s,n)=>t.jsxs("div",{children:[s.ctg," → ",(s.invAmt/1e12).toFixed(1),"조"]},n))}),t.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-[5px] border-r-[5px] border-t-[5px] border-transparent border-t-[#4A3F35]"})]})})()]})]}),l.length>0&&l[0].basDt&&t.jsxs("span",{className:"text-[9px] text-[#8B7E74] whitespace-nowrap ml-2",children:[l[0].basDt?.slice(0,4),"년 ",parseInt(l[0].basDt?.slice(4,6)),"월 기준"]})]}),R?t.jsx("p",{className:"text-xs text-gray-400",children:"데이터를 불러오는 중이에요..."}):l.length>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex justify-end mb-4",children:t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:a=>{a.stopPropagation(),m(!g),f(!1),N()},className:"text-[10px] text-[#C4956A] underline underline-offset-2",children:"세금혜택 알아보기"}),g&&t.jsxs("div",{className:"absolute bottom-full right-0 mb-2 bg-[#4A3F35] rounded-lg px-3 py-2 whitespace-nowrap z-10",children:[t.jsx("p",{className:"text-[11px] text-white tracking-tighter",children:"ISA는 수익에서 손실을 뺀 '순수익'에 대해서만 세금을 계산해서 훨씬 유리해요!"}),t.jsx("div",{className:"absolute top-full right-3 w-0 h-0 border-l-[5px] border-r-[5px] border-t-[5px] border-transparent border-t-[#4A3F35]"})]})]})}),t.jsx("div",{className:"flex justify-between gap-3",children:l.map((a,s)=>{const n=Math.max(...l.map(c=>Math.abs(parseFloat(c.bnfRt||0)))),d=parseFloat(a.bnfRt||0),o=n>0?Math.abs(d)/n*140:0,i=d>=0;return t.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[t.jsxs("div",{className:"w-full flex flex-col justify-end items-center relative",style:{height:"140px"},children:[t.jsx("div",{className:"absolute",style:{bottom:`${o}px`},children:t.jsxs("span",{className:`text-xs font-bold ${i?"text-[#059669]":"text-[#DC2626]"}`,children:[i?"+":"",d,"%"]})}),t.jsx("div",{className:`w-full rounded-t-lg transition-all duration-1000 ${s===0?"bg-[#FF8A00]":i?"bg-[#34D399]":"bg-[#F87171]"}`,style:{height:`${o}px`}})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("span",{className:`text-xs font-bold ${s===0?"text-[#FF8A00]":"text-[#4A3F35]"}`,children:[s+1,"위"]}),t.jsx("p",{className:"text-[10px] text-[#4A3F35] mt-1 break-words",children:a.cmpyNm}),t.jsx("p",{className:"text-[9px] text-gray-500",children:a.mpTp})]})]},s)})})]}):t.jsx("p",{className:"text-xs text-gray-400",children:"데이터를 불러올 수 없어요."})]})}),t.jsx("div",{className:"px-6 pb-2 mt-4 flex justify-end",children:t.jsx("p",{className:"text-[11px] text-[#8B7E74]",children:"* 출처: 금융위원회 ISA 통계"})})]})}export{J as default};
